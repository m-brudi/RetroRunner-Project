<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_gun</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-10</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>canShoot = true;


if(global.shotgunAmmo == 0){
    shotgunClip = 0;
}else if(global.shotgunAmmo &lt; global.weaponArray[1,7]){
    shotgunClip = global.shotgunAmmo;
}else{
    shotgunClip = global.weaponArray[1,7];
}

if(global.machineAmmo == 0){
    machineClip = 0;
}else if(global.machineAmmo &lt; global.weaponArray[2,7]){
    machineClip = global.machineAmmo;
}else{
    machineClip = global.weaponArray[2,7];
} 

clipsize = global.weaponArray[global.weapon,7]; 


//magazynek karabinu


canShotgun = true;

shakeIntensity = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///SHAKE
shakeIntensity -=10;
alarm[2] = 0.2*room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Reload

if(global.weaponArray[global.weapon,13]){   //if Machinegun
    
    if(global.machineAmmo == 0){
        machineClip = 0;
    }else if(global.machineAmmo &lt; 30){
        machineClip = global.machineAmmo;
    }else{
        machineClip = global.weaponArray[global.weapon,7];
    }
    
}else if(global.weaponArray[global.weapon,12]){  //if shotgun
    if(global.shotgunAmmo == 0){
        shotgunClip = 0;
    }else if(global.shotgunAmmo &lt; 2){
        shotgunClip = global.shotgunAmmo;
    }else{
        shotgunClip = global.weaponArray[global.weapon,7];
    }
}else{
        clipsize = global.weaponArray[global.weapon,7];
}

canShoot = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///lag between shots
canShoot = true;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Shake effect

if(shakeIntensity &gt; 0){
    
    view_xview[0] +=choose(random(shakeIntensity),random(-shakeIntensity));
    view_yview[0] +=choose(random(shakeIntensity),random(-shakeIntensity));
}



</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// animation and image angle
image_speed=.3;

//direction
image_angle = point_direction(x,y,mouse_x,mouse_y);

if(mouse_x &lt; x){
    image_angle = point_direction(x,y,x,y-10);
}


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///SHOOTING
if(global.death) exit;
//weapon = global.weapon;


if((global.shotgunAmmo == 0)&amp;&amp;(shotgunClip == 0)&amp;&amp;(!global.infiniteAmmo)){
    canShotgun = false;
}else if(global.infiniteAmmo){
    canShotgun = true;
}else{
    canShotgun = true;
} 

if((global.machineAmmo == 0)&amp;&amp;(machineClip == 0)&amp;&amp;(!global.infiniteAmmo)){
    canMachine = false;
}else if(global.infiniteAmmo){
    canMachine = true;
}else{
    canMachine = true;
}

//sound of an empty clip
if (mouse_check_button_pressed(mb_left)) {   
    if(global.weapon == 1 &amp;&amp; global.shotgunAmmo == 0){  //shotgun
        if(global.sfx){
            audio_play_sound(snd_emptyClip,1,0);
        }
    }else if(global.weapon == 2 &amp;&amp; global.machineAmmo == 0){
        if(global.sfx){
            audio_play_sound(snd_emptyClip,1,0);
        }
    }
}



if(canShoot){
     
    if(!global.weaponArray[global.weapon,13]){
    
        if (mouse_check_button_pressed(mb_left)) {   
            
            if(mouse_x &gt; obj_player.x){
                //nie strzelaj gdy klikasz pause
                if(!((mouse_x &gt; (view_xview[0]+view_wview[0])-200) &amp;&amp; (mouse_y &lt; 100))){  
                
                    if(global.weaponArray[global.weapon,12]){ //if shotgun
                        
                        if(canShotgun){
                        
                            repeat(4){
                                bul = instance_create(x,y,obj_bulletShotgun);
                                bul.speed = 30;
                            }
                            if(!global.infiniteAmmo)global.shotgunAmmo -= .5;
                            
                            shakeIntensity = global.weaponArray[global.weapon,9];
                            alarm[2] = global.weaponArray[global.weapon,10] * room_speed;
                            
                            if(global.sfx){
                                audio_play_sound(global.weaponArray[global.weapon,11],0,0);
                            }
                            
                            if(!global.infiniteAmmo)shotgunClip--;
        
                            if(shotgunClip &gt; 0){
                                alarm[0] = global.weaponArray[global.weapon,8];
                            }
                            if(shotgunClip == 0 &amp;&amp; (!global.infiniteAmmo)){
                                alarm[1] = global.weaponArray[global.weapon,2];
                            }else if(shotgunClip == 0 &amp;&amp; (global.infiniteAmmo)){
                                alarm[0] = global.weaponArray[global.weapon,8];
                            }                        
                            canShoot = false; 
                        }
                    
                    }else{ 
                        bul = instance_create(x+lengthdir_x(global.weaponArray[global.weapon,4],obj_gun.image_angle),y,global.weaponArray[global.weapon,3]);
                        bul.speed = 30;
                    
                    
                        shakeIntensity = global.weaponArray[global.weapon,9];
                        alarm[2] = global.weaponArray[global.weapon,10] * room_speed;
                            
                        if(global.sfx){    
                            audio_play_sound(global.weaponArray[global.weapon,11],0,0);
                        }
                        
                        if(!global.infiniteAmmo)clipsize--;
                        
                        if(clipsize &gt; 0){
                            alarm[0] = global.weaponArray[global.weapon,8];
                        }
                        if(clipsize == 0){
                            alarm[1] = global.weaponArray[global.weapon,2];
                        }
                            
                        canShoot = false;
                        
                    }
                }
            }   
       }
        //For MachineGun
        
    }else{
        
        if (mouse_check_button(mb_left)) {   
        
            if((mouse_x &gt; obj_player.x)&amp;&amp; canMachine){
            
                if(!((mouse_x &gt;(view_xview[0]+view_wview[0])-200) &amp;&amp; (mouse_y &lt; 100))){  
               
                    bul = instance_create(x+lengthdir_x(global.weaponArray[global.weapon,4],obj_gun.image_angle),y,global.weaponArray[global.weapon,3]);
                    bul.speed = 30;
                    //DLACZEGO TO ODEJMUJE PODWOJNIE?! NIE WIE NIKT...
                    if(!global.infiniteAmmo)global.machineAmmo -= .5;
            
            
                    shakeIntensity = global.weaponArray[global.weapon,9];
                    alarm[2] = global.weaponArray[global.weapon,10] * room_speed;
            
                    if(global.sfx){   
                        audio_play_sound(global.weaponArray[global.weapon,11],0,0);
                    }
                    
                    if(!global.infiniteAmmo)machineClip--;
        
                    if(machineClip &gt; 0){
                        alarm[0] = global.weaponArray[global.weapon,8];
                    }
                    if(machineClip == 0 &amp;&amp; (!global.infiniteAmmo)){
                        alarm[1] = global.weaponArray[global.weapon,2];
                    }else if(machineClip == 0 &amp;&amp; (global.infiniteAmmo)){
                        alarm[0] = global.weaponArray[global.weapon,8];     
                        //canShoot = false;    
                    }
                    //if(!global.infiniteAmmo){
                        canShoot = false;
                    //}
                                   
                }
                        
            }
            
        }
        
    }
        
} 

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="61">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(weapon &gt; 0){
    weapon--;
}else{
    weapon = global.weapons;
}
global.weapon = weapon;
clipsize = global.weaponArray[global.weapon,7];
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///AMMO display

draw_self();
sprite_index = global.weaponArray[global.weapon,1]
    
if(!global.pause){    
    //drawing ammo stats
    if(global.weaponArray[global.weapon,13]){  //machingun
        clipstring = string(machineClip);
        clipstring+=" / "+string(global.machineAmmo-machineClip);
        
    }else if(global.weaponArray[global.weapon,12]){  //shotgun
        clipstring = string(shotgunClip);
        clipstring +=" / "+string(global.shotgunAmmo-shotgunClip);
    }else{
        clipstring = string(clipsize)
        clipstring +=" / -";
    }
    draw_set_halign(fa_left);
    draw_set_valign(fa_top);
    draw_text(view_xview[0]+40, view_yview[0]+100,clipstring);

}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="86">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(weapon &lt; global.weapons){
    weapon++;
}else{
    weapon = 0;
}
global.weapon = weapon;
clipsize = global.weaponArray[global.weapon,7];
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
